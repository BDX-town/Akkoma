(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{680:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return U});function s(e){return{settings:Object(D.f)(e),tokens:e.getIn(["security","tokens"])}}var i,n,o,c,r,d,u,l,b,p,f,h,m,j,g,O,v,w,y=a(0),M=a(2),S=a(6),k=a(1),_=(a(3),a(8)),C=a(9),L=a(32),P=a(13),F=a(4),N=a.n(F),A=a(15),R=a.n(A),q=a(227),T=a(53),I=a(62),E=a(25),H=a(589),x=a(50),D=a(20),J=Object(C.c)({heading:{id:"column.security",defaultMessage:"Security"},submit:{id:"security.submit",defaultMessage:"Save changes"},updateEmailSuccess:{id:"security.update_email.success",defaultMessage:"Email successfully updated."},updateEmailFail:{id:"security.update_email.fail",defaultMessage:"Update email failed."},updatePasswordSuccess:{id:"security.update_password.success",defaultMessage:"Password successfully updated."},updatePasswordFail:{id:"security.update_password.fail",defaultMessage:"Update password failed."},emailFieldLabel:{id:"security.fields.email.label",defaultMessage:"Email address"},passwordFieldLabel:{id:"security.fields.password.label",defaultMessage:"Password"},oldPasswordFieldLabel:{id:"security.fields.old_password.label",defaultMessage:"Current password"},newPasswordFieldLabel:{id:"security.fields.new_password.label",defaultMessage:"New password"},confirmationFieldLabel:{id:"security.fields.password_confirmation.label",defaultMessage:"New password (again)"},revoke:{id:"security.tokens.revoke",defaultMessage:"Revoke"},emailHeader:{id:"security.headers.update_email",defaultMessage:"Change Email"},passwordHeader:{id:"security.headers.update_password",defaultMessage:"Change Password"},tokenHeader:{id:"security.headers.tokens",defaultMessage:"Sessions"},deleteHeader:{id:"security.headers.delete",defaultMessage:"Delete Account"},deleteText:{id:"security.text.delete",defaultMessage:"To delete your account, enter your password then click Delete Account. This is a permanent action that cannot be undone. Your account will be destroyed from this server, and a deletion request will be sent to other servers. It's not guaranteed that all servers will purge your account."},deleteSubmit:{id:"security.submit.delete",defaultMessage:"Delete Account"},deleteAccountSuccess:{id:"security.delete_account.success",defaultMessage:"Account successfully deleted."},deleteAccountFail:{id:"security.delete_account.fail",defaultMessage:"Account deletion failed."},mfa:{id:"security.mfa",defaultMessage:"Set up 2-Factor Auth"},mfa_setup_hint:{id:"security.mfa_setup_hint",defaultMessage:"Configure multi-factor authentication with OTP"},mfa_enabled:{id:"security.mfa_enabled",defaultMessage:"You have multi-factor authentication set up with OTP."},disable_mfa:{id:"security.disable_mfa",defaultMessage:"Disable"},mfaHeader:{id:"security.mfa_header",defaultMessage:"Authorization Methods"}}),U=Object(_.connect)(s)(O=Object(L.c)((w=v=function(e){function t(){return e.apply(this,arguments)||this}return Object(S.a)(t,e),t.prototype.render=function(){var e=this.props.intl;return Object(y.a)(q.a,{icon:"lock",heading:e.formatMessage(J.heading),backBtnSlim:!0},void 0,Object(y.a)(Y,{}),Object(y.a)(z,{}),Object(y.a)(B,{}),Object(y.a)(G,{}),Object(y.a)(K,{}))},t}(P.a),Object(k.a)(v,"propTypes",{dispatch:N.a.func.isRequired,intl:N.a.object.isRequired}),O=w))||O)||O,Y=Object(_.connect)()(i=Object(L.c)((o=n=function(s){function e(){for(var c,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return c=s.call.apply(s,[this].concat(t))||this,Object(k.a)(Object(M.a)(c),"state",{email:"",password:"",isLoading:!1}),Object(k.a)(Object(M.a)(c),"handleInputChange",function(e){var t;c.setState(((t={})[e.target.name]=e.target.value,t))}),Object(k.a)(Object(M.a)(c),"handleSubmit",function(e){var t=c.state,a=t.email,s=t.password,i=c.props,n=i.dispatch,o=i.intl;return c.setState({isLoading:!0}),n(Object(E.j)(a,s)).then(function(){c.setState({email:"",password:""}),n(x.a.success(o.formatMessage(J.updateEmailSuccess)))}).catch(function(e){c.setState({password:""}),n(x.a.error(o.formatMessage(J.updateEmailFail)))}).then(function(){c.setState({isLoading:!1})})}),c}return Object(S.a)(e,s),e.prototype.render=function(){var e=this.props.intl;return Object(y.a)(I.i,{onSubmit:this.handleSubmit},void 0,Object(y.a)("h2",{},void 0,e.formatMessage(J.emailHeader)),Object(y.a)("fieldset",{disabled:this.state.isLoading},void 0,Object(y.a)(I.b,{},void 0,Object(y.a)(I.l,{label:e.formatMessage(J.emailFieldLabel),placeholder:"me@example.com",name:"email",onChange:this.handleInputChange,value:this.state.email}),Object(y.a)(I.j,{type:"password",label:e.formatMessage(J.passwordFieldLabel),name:"password",onChange:this.handleInputChange,value:this.state.password}),Object(y.a)("div",{className:"actions"},void 0,Object(y.a)("button",{name:"button",type:"submit",className:"btn button button-primary"},void 0,e.formatMessage(J.submit))))))},e}(P.a),Object(k.a)(n,"propTypes",{email:N.a.string,dispatch:N.a.func.isRequired,intl:N.a.object.isRequired}),i=o))||i)||i,z=Object(_.connect)()(c=Object(L.c)((d=r=function(s){function e(){for(var r,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return r=s.call.apply(s,[this].concat(t))||this,Object(k.a)(Object(M.a)(r),"state",{oldPassword:"",newPassword:"",confirmation:"",isLoading:!1}),Object(k.a)(Object(M.a)(r),"handleInputChange",function(e){var t;r.setState(((t={})[e.target.name]=e.target.value,t))}),Object(k.a)(Object(M.a)(r),"clearForm",function(){r.setState({oldPassword:"",newPassword:"",confirmation:""})}),Object(k.a)(Object(M.a)(r),"handleSubmit",function(e){var t=r.state,a=t.oldPassword,s=t.newPassword,i=t.confirmation,n=r.props,o=n.dispatch,c=n.intl;return r.setState({isLoading:!0}),o(Object(E.k)(a,s,i)).then(function(){r.clearForm(),o(x.a.success(c.formatMessage(J.updatePasswordSuccess)))}).catch(function(e){r.clearForm(),o(x.a.error(c.formatMessage(J.updatePasswordFail)))}).then(function(){r.setState({isLoading:!1})})}),r}return Object(S.a)(e,s),e.prototype.render=function(){var e=this.props.intl;return Object(y.a)(I.i,{onSubmit:this.handleSubmit},void 0,Object(y.a)("h2",{},void 0,e.formatMessage(J.passwordHeader)),Object(y.a)("fieldset",{disabled:this.state.isLoading},void 0,Object(y.a)(I.b,{},void 0,Object(y.a)(I.j,{type:"password",label:e.formatMessage(J.oldPasswordFieldLabel),name:"oldPassword",onChange:this.handleInputChange,value:this.state.oldPassword}),Object(y.a)(I.j,{type:"password",label:e.formatMessage(J.newPasswordFieldLabel),name:"newPassword",onChange:this.handleInputChange,value:this.state.newPassword}),Object(y.a)(I.j,{type:"password",label:e.formatMessage(J.confirmationFieldLabel),name:"confirmation",onChange:this.handleInputChange,value:this.state.confirmation}),Object(y.a)("div",{className:"actions"},void 0,Object(y.a)("button",{name:"button",type:"submit",className:"btn button button-primary"},void 0,e.formatMessage(J.submit))))))},e}(P.a),Object(k.a)(r,"propTypes",{dispatch:N.a.func.isRequired,intl:N.a.object.isRequired}),c=d))||c)||c,B=Object(_.connect)(s)(u=Object(L.c)((b=l=function(a){function e(e){var t=a.call(this,e)||this;return Object(k.a)(Object(M.a)(t),"handleMfaClick",function(e){t.context.router.history.push("../auth/mfa")}),t.props.dispatch(Object(H.e)()).then(function(e){t.props.dispatch(Object(D.d)(["otpEnabled"],e.data.settings.enabled))}).catch(function(e){return e}),t}return Object(S.a)(e,a),e.prototype.render=function(){var e=this.props,t=e.intl,a=e.settings;return Object(y.a)(I.i,{},void 0,Object(y.a)("h2",{},void 0,t.formatMessage(J.mfaHeader)),!1===a.get("otpEnabled")?Object(y.a)("div",{},void 0,Object(y.a)("p",{className:"hint"},void 0,t.formatMessage(J.mfa_setup_hint)),Object(y.a)(T.a,{className:"button button-secondary set-up-mfa",text:t.formatMessage(J.mfa),onClick:this.handleMfaClick})):Object(y.a)("div",{},void 0,Object(y.a)("p",{className:"hint"},void 0,t.formatMessage(J.mfa_enabled)),Object(y.a)(T.a,{className:"button button--destructive disable-mfa",text:t.formatMessage(J.disable_mfa),onClick:this.handleMfaClick})))},e}(P.a),Object(k.a)(l,"contextTypes",{router:N.a.object}),Object(k.a)(l,"propTypes",{intl:N.a.object.isRequired,settings:R.a.map.isRequired}),u=b))||u)||u,G=Object(_.connect)(s)(p=Object(L.c)((h=f=function(i){function e(){for(var a,e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return a=i.call.apply(i,[this].concat(t))||this,Object(k.a)(Object(M.a)(a),"handleRevoke",function(t){return function(e){a.props.dispatch(Object(E.u)(t))}}),a}Object(S.a)(e,i);var t=e.prototype;return t.componentDidMount=function(){this.props.dispatch(Object(E.n)())},t.render=function(){var a=this,e=this.props,t=e.tokens,s=e.intl;return t.isEmpty()?null:Object(y.a)(I.i,{},void 0,Object(y.a)("h2",{},void 0,s.formatMessage(J.tokenHeader)),Object(y.a)("div",{className:"authtokens"},void 0,t.reverse().map(function(e,t){return Object(y.a)("div",{className:"authtoken"},t,Object(y.a)("div",{className:"authtoken__app-name"},void 0,e.get("app_name")),Object(y.a)("div",{className:"authtoken__valid-until"},void 0,Object(y.a)(C.a,{value:new Date(e.get("valid_until")),hour12:!1,year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})),Object(y.a)("div",{className:"authtoken__revoke"},void 0,Object(y.a)("button",{onClick:a.handleRevoke(e.get("id"))},void 0,a.props.intl.formatMessage(J.revoke))))})))},e}(P.a),Object(k.a)(f,"propTypes",{dispatch:N.a.func.isRequired,intl:N.a.object.isRequired,tokens:R.a.list}),p=h))||p)||p,K=Object(_.connect)(s)(m=Object(L.c)((g=j=function(s){function e(){for(var n,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n=s.call.apply(s,[this].concat(t))||this,Object(k.a)(Object(M.a)(n),"state",{password:"",isLoading:!1}),Object(k.a)(Object(M.a)(n),"handleInputChange",function(e){var t;n.setState(((t={})[e.target.name]=e.target.value,t))}),Object(k.a)(Object(M.a)(n),"handleSubmit",function(e){var t=n.state.password,a=n.props,s=a.dispatch,i=a.intl;return n.setState({isLoading:!0}),s(Object(E.l)(t)).then(function(){s(x.a.success(i.formatMessage(J.deleteAccountSuccess)))}).catch(function(e){n.setState({password:""}),s(x.a.error(i.formatMessage(J.deleteAccountFail)))}).then(function(){n.setState({isLoading:!1})})}),n}return Object(S.a)(e,s),e.prototype.render=function(){var e=this.props.intl;return Object(y.a)(I.i,{onSubmit:this.handleSubmit},void 0,Object(y.a)("h2",{},void 0,e.formatMessage(J.deleteHeader)),Object(y.a)("p",{className:"hint"},void 0,e.formatMessage(J.deleteText)),Object(y.a)("fieldset",{disabled:this.state.isLoading},void 0,Object(y.a)(I.b,{},void 0,Object(y.a)(I.j,{type:"password",label:e.formatMessage(J.passwordFieldLabel),name:"password",onChange:this.handleInputChange,value:this.state.password}),Object(y.a)("div",{className:"actions"},void 0,Object(y.a)("button",{name:"button",type:"submit",className:"btn button button-primary"},void 0,e.formatMessage(J.deleteSubmit))))))},e}(P.a),Object(k.a)(j,"propTypes",{dispatch:N.a.func.isRequired,intl:N.a.object.isRequired}),m=g))||m)||m}}]);
//# sourceMappingURL=security-6ce7bbe38e001b769704.chunk.js.map