{"version":3,"sources":["webpack:///./app/soapbox/features/status/components/status_interaction_bar.js","webpack:///./app/soapbox/features/status/components/detailed_status.js","webpack:///./app/soapbox/features/status/components/action_bar.js","webpack:///./app/soapbox/features/status/index.js"],"names":["StatusInteractionBar","connect","state","allowedEmoji","getSoapboxConfig","get","status","props","reduceEmoji","getIn","reverse","Link","to","className","id","value","render","emojiReacts","this","getNormalizedReacts","count","reduce","acc","cur","repost","getRepost","map","e","i","dangerouslySetInnerHTML","__html","emojify","ImmutablePureComponent","ImmutablePropTypes","me","SoapboxPropTypes","list","DetailedStatus","height","media","startTime","onOpenVideo","onToggleHidden","c","node","_measureHeight","href","preventDefault","target","nodeName","parentNode","window","open","heightJustChanged","measureHeight","scheduleIdleTask","setState","Math","ceil","scrollHeight","onHeightChange","componentDidUpdate","prevProps","prevState","outerStyle","boxSizing","compact","favicon","domain","getDomain","video","audio","poll","statusTypeIcon","pollId","size","preview","blurhash","src","alt","aspectRatio","width","inline","handleOpenVideo","sensitive","visible","showMedia","onToggleVisibility","onToggleMediaVisibility","standalone","onOpenMedia","length","card","style","ref","setRef","classNames","NavLink","accountId","account","title","expanded","onExpandedToggle","handleExpandedToggle","rel","Date","hour12","year","month","day","hour","minute","router","PropTypes","object","func","isRequired","bool","string","messages","defineMessages","delete","redraft","direct","mention","reply","reblog","reblog_private","cancel_reblog_private","cannot_reblog","favourite","mute","muteConversation","unmuteConversation","block","report","share","pin","unpin","embed","admin_account","admin_status","copy","bookmark","unbookmark","deactivateUser","deleteUser","deleteStatus","markStatusSensitive","markStatusNotSensitive","ActionBar","emojiSelectorVisible","onReply","onOpenUnauthorizedModal","onReblog","onBookmark","onFavourite","matchMedia","matches","isMobile","meEmojiReact","getReactForStatus","handleReactClick","emoji","onEmojiReact","onDelete","context","history","onDirect","onMention","onMute","onMuteConversation","onBlock","onReport","onPin","navigator","text","url","onEmbed","textarea","document","createElement","textContent","position","body","appendChild","select","execCommand","removeChild","onDeactivateUser","onDeleteUser","onToggleStatusSensitivity","onDeleteStatus","componentDidMount","addEventListener","contains","intl","isStaff","publicStatus","includes","mutingConversation","menu","push","formatMessage","action","handleCopy","handleBookmarkClick","handlePinClick","handleReblogClick","handleConversationMuteClick","handleDeleteClick","handleRedraftClick","name","handleMentionClick","handleMuteClick","handleBlockClick","handleReport","handleDeactivateUser","handleDeleteUser","handleToggleStatusSensitivity","handleDeleteStatus","shareButton","icon","onClick","handleShare","replyIcon","reblogIcon","reblog_disabled","handleReplyClick","disabled","active","onMouseEnter","handleLikeButtonHover","onMouseLeave","handleLikeButtonLeave","onReact","animate","Boolean","handleLikeButtonClick","items","direction","React","PureComponent","injectIntl","dispatch","openModal","deleteConfirm","deleteMessage","redraftConfirm","redraftMessage","blockConfirm","revealAll","hideAll","detailedStatus","replyConfirm","replyMessage","blockAndReport","Status","getStatus","makeGetStatus","params","statusId","username","ancestorsIds","Immutable","List","descendantsIds","withMutations","mutable","unshift","ids","shift","replies","forEach","askReplyConfirmation","trim","displayMedia","getSettings","fullscreen","defaultMediaVisibility","loadedStatusId","undefined","simpleEmojiReact","unfavourite","message","confirm","onConfirm","replyCompose","_","getState","boostModal","unreblog","shiftKey","handleModalReblog","withRedraft","deleteModal","directCompose","mentionCompose","index","time","initMuteModal","unmuteStatus","muteStatus","revealStatus","hideStatus","statusIds","concat","toJS","defaultMessage","values","blockAccount","secondary","onSecondary","initReport","deactivateUserModal","deleteUserModal","toggleStatusSensitivityModal","deleteStatusModal","handleMoveUp","handleMoveDown","handleFavouriteClick","handleToggleHidden","handleToggleMediaVisibility","_selectChild","indexOf","isFullscreen","fetchStatus","attachFullscreenListener","onFullScreenChange","align_top","container","element","querySelectorAll","scrollTop","offsetTop","scrollIntoView","clientHeight","offsetHeight","focus","renderChildren","onMoveUp","onMoveDown","contextType","_scrolledIntoView","querySelector","requestAnimationFrame","componentWillUnmount","detachFullscreenListener","ancestors","descendants","handlers","moveUp","handleHotkeyMoveUp","moveDown","handleHotkeyMoveDown","handleHotkeyReply","handleHotkeyFavourite","boost","handleHotkeyBoost","handleHotkeyMention","openProfile","handleHotkeyOpenProfile","toggleHidden","handleHotkeyToggleHidden","toggleSensitive","handleHotkeyToggleSensitive","label","extraButton","aria-label","handleToggleAll","aria-pressed","tabIndex","textForScreenReader","handleOpenMedia","handleEmojiReactClick","handleDirectClick","handlePin","handleBookmark","handleEmbed"],"mappings":"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","file":"js/features/status-83214925a2c40e37e02d.chunk.js","sourcesContent":["import React from 'react';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport ImmutablePureComponent from 'react-immutable-pure-component';\nimport { connect } from 'react-redux';\nimport { FormattedNumber } from 'react-intl';\nimport emojify from 'soapbox/features/emoji/emoji';\nimport { reduceEmoji } from 'soapbox/utils/emoji_reacts';\nimport SoapboxPropTypes from 'soapbox/utils/soapbox_prop_types';\nimport { Link } from 'react-router-dom';\nimport Icon from 'soapbox/components/icon';\nimport { getSoapboxConfig } from 'soapbox/actions/soapbox';\n\nconst mapStateToProps = state => ({\n  allowedEmoji: getSoapboxConfig(state).get('allowedEmoji'),\n});\n\nexport default @connect(mapStateToProps)\nclass StatusInteractionBar extends ImmutablePureComponent {\n\n  static propTypes = {\n    status: ImmutablePropTypes.map,\n    me: SoapboxPropTypes.me,\n    allowedEmoji: ImmutablePropTypes.list,\n  }\n\n  getNormalizedReacts = () => {\n    const { status } = this.props;\n    return reduceEmoji(\n      status.getIn(['pleroma', 'emoji_reactions']),\n      status.get('favourites_count'),\n      status.get('favourited'),\n      this.props.allowedEmoji,\n    ).reverse();\n  }\n\n  getRepost = () => {\n    const { status } = this.props;\n    if (status.get('reblogs_count')) {\n      return (\n        <Link to={`/@${status.getIn(['account', 'acct'])}/posts/${status.get('id')}/reblogs`} className='emoji-react emoji-react--reblogs'>\n          <Icon id='retweet' />\n          <span className='emoji-reacts__count'>\n            <FormattedNumber value={status.get('reblogs_count')} />\n          </span>\n        </Link>\n      );\n    }\n\n    return '';\n  }\n\n  render() {\n    const emojiReacts = this.getNormalizedReacts();\n    const count = emojiReacts.reduce((acc, cur) => (\n      acc + cur.get('count')\n    ), 0);\n    const repost = this.getRepost();\n\n    const EmojiReactsContainer = () => (\n      <div className='emoji-reacts-container'>\n        <div className='emoji-reacts'>\n          {emojiReacts.map((e, i) => (\n            <span className='emoji-react' key={i}>\n              <span\n                className='emoji-react__emoji'\n                dangerouslySetInnerHTML={{ __html: emojify(e.get('name')) }}\n              />\n              <span className='emoji-react__count'>{e.get('count')}</span>\n            </span>\n          ))}\n        </div>\n        <div className='emoji-reacts__count'>\n          {count}\n        </div>\n      </div>\n    );\n\n    return (\n      <div className='status-interaction-bar'>\n        {count > 0 && <EmojiReactsContainer />}\n        {repost}\n      </div>\n    );\n  }\n\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport Avatar from '../../../components/avatar';\nimport DisplayName from '../../../components/display_name';\nimport StatusContent from '../../../components/status_content';\nimport MediaGallery from '../../../components/media_gallery';\nimport { Link, NavLink } from 'react-router-dom';\nimport { FormattedDate } from 'react-intl';\nimport Card from './card';\nimport ImmutablePureComponent from 'react-immutable-pure-component';\nimport Video from '../../video';\nimport Audio from '../../audio';\nimport scheduleIdleTask from '../../ui/util/schedule_idle_task';\nimport classNames from 'classnames';\nimport Icon from 'soapbox/components/icon';\nimport PollContainer from 'soapbox/containers/poll_container';\nimport StatusInteractionBar from './status_interaction_bar';\nimport { getDomain } from 'soapbox/utils/accounts';\nimport HoverRefWrapper from 'soapbox/components/hover_ref_wrapper';\n\nexport default class DetailedStatus extends ImmutablePureComponent {\n\n  static contextTypes = {\n    router: PropTypes.object,\n  };\n\n  static propTypes = {\n    status: ImmutablePropTypes.map,\n    onOpenMedia: PropTypes.func.isRequired,\n    onOpenVideo: PropTypes.func.isRequired,\n    onToggleHidden: PropTypes.func.isRequired,\n    measureHeight: PropTypes.bool,\n    onHeightChange: PropTypes.func,\n    domain: PropTypes.string,\n    compact: PropTypes.bool,\n    showMedia: PropTypes.bool,\n    onToggleMediaVisibility: PropTypes.func,\n  };\n\n  state = {\n    height: null,\n  };\n\n  handleOpenVideo = (media, startTime) => {\n    this.props.onOpenVideo(media, startTime);\n  }\n\n  handleExpandedToggle = () => {\n    this.props.onToggleHidden(this.props.status);\n  }\n\n  _measureHeight(heightJustChanged) {\n    if (this.props.measureHeight && this.node) {\n      scheduleIdleTask(() => this.node && this.setState({ height: Math.ceil(this.node.scrollHeight) + 1 }));\n\n      if (this.props.onHeightChange && heightJustChanged) {\n        this.props.onHeightChange();\n      }\n    }\n  }\n\n  setRef = c => {\n    this.node = c;\n    this._measureHeight();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    this._measureHeight(prevState.height !== this.state.height);\n  }\n\n  handleModalLink = e => {\n    e.preventDefault();\n\n    let href;\n\n    if (e.target.nodeName !== 'A') {\n      href = e.target.parentNode.href;\n    } else {\n      href = e.target.href;\n    }\n\n    window.open(href, 'soapbox-intent', 'width=445,height=600,resizable=no,menubar=no,status=no,scrollbars=yes');\n  }\n\n  render() {\n    const status = (this.props.status && this.props.status.get('reblog')) ? this.props.status.get('reblog') : this.props.status;\n    const outerStyle = { boxSizing: 'border-box' };\n    const { compact } = this.props;\n    const favicon = status.getIn(['account', 'pleroma', 'favicon']);\n    const domain = getDomain(status.get('account'));\n\n    if (!status) {\n      return null;\n    }\n\n    let media           = '';\n    let poll = '';\n    let statusTypeIcon = '';\n\n    if (this.props.measureHeight) {\n      outerStyle.height = `${this.state.height}px`;\n    }\n\n    if (status.get('poll')) {\n      poll = <PollContainer pollId={status.get('poll')} />;\n    }\n    if (status.get('media_attachments').size > 0) {\n      if (status.getIn(['media_attachments', 0, 'type']) === 'video') {\n        const video = status.getIn(['media_attachments', 0]);\n\n        media = (\n          <Video\n            preview={video.get('preview_url')}\n            blurhash={video.get('blurhash')}\n            src={video.get('url')}\n            alt={video.get('description')}\n            aspectRatio={video.getIn(['meta', 'small', 'aspect'])}\n            width={300}\n            height={150}\n            inline\n            onOpenVideo={this.handleOpenVideo}\n            sensitive={status.get('sensitive')}\n            visible={this.props.showMedia}\n            onToggleVisibility={this.props.onToggleMediaVisibility}\n          />\n        );\n      } else if (status.getIn(['media_attachments', 0, 'type']) === 'audio' && status.get('media_attachments').size === 1) {\n        const audio = status.getIn(['media_attachments', 0]);\n\n        media = (\n          <Audio\n            src={audio.get('url')}\n            alt={audio.get('description')}\n            inline\n            sensitive={status.get('sensitive')}\n            visible={this.props.showMedia}\n            onToggleVisibility={this.props.onToggleMediaVisibility}\n          />\n        );\n      } else {\n        media = (\n          <MediaGallery\n            standalone\n            sensitive={status.get('sensitive')}\n            media={status.get('media_attachments')}\n            height={300}\n            onOpenMedia={this.props.onOpenMedia}\n            visible={this.props.showMedia}\n            onToggleVisibility={this.props.onToggleMediaVisibility}\n          />\n        );\n      }\n    } else if (status.get('spoiler_text').length === 0) {\n      media = <Card onOpenMedia={this.props.onOpenMedia} card={status.get('card', null)} />;\n    }\n\n    if (status.get('visibility') === 'direct') {\n      statusTypeIcon = <Icon id='envelope' />;\n    } else if (status.get('visibility') === 'private') {\n      statusTypeIcon = <Icon id='lock' />;\n    }\n\n    return (\n      <div style={outerStyle}>\n        <div ref={this.setRef} className={classNames('detailed-status', { compact })}>\n          <div className='detailed-status__profile'>\n            <div className='detailed-status__display-name'>\n              <NavLink to={`/@${status.getIn(['account', 'acct'])}`}>\n                <div className='detailed-status__display-avatar'>\n                  <HoverRefWrapper accountId={status.getIn(['account', 'id'])}>\n                    <Avatar account={status.get('account')} size={48} />\n                  </HoverRefWrapper>\n                </div>\n              </NavLink>\n              <DisplayName account={status.get('account')}>\n                <HoverRefWrapper accountId={status.getIn(['account', 'id'])}>\n                  <NavLink className='floating-link' to={`/@${status.getIn(['account', 'acct'])}`} title={status.getIn(['account', 'acct'])} />\n                </HoverRefWrapper>\n              </DisplayName>\n            </div>\n          </div>\n\n          {status.get('group') && (\n            <div className='status__meta'>\n              Posted in <NavLink to={`/groups/${status.getIn(['group', 'id'])}`}>{status.getIn(['group', 'title'])}</NavLink>\n            </div>\n          )}\n\n          <StatusContent status={status} expanded={!status.get('hidden')} onExpandedToggle={this.handleExpandedToggle} />\n\n          {media}\n          {poll}\n\n          <div className='detailed-status__meta'>\n            <StatusInteractionBar status={status} />\n            <div>\n              {favicon &&\n                <div className='status__favicon'>\n                  <Link to={`/timeline/${domain}`}>\n                    <img src={favicon} alt='' title={domain} />\n                  </Link>\n                </div>}\n\n              {statusTypeIcon}<a className='detailed-status__datetime' href={status.get('url')} target='_blank' rel='noopener'>\n                <FormattedDate value={new Date(status.get('created_at'))} hour12={false} year='numeric' month='short' day='2-digit' hour='2-digit' minute='2-digit' />\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { openModal } from '../../../actions/modal';\nimport PropTypes from 'prop-types';\nimport SoapboxPropTypes from 'soapbox/utils/soapbox_prop_types';\nimport IconButton from '../../../components/icon_button';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport DropdownMenuContainer from '../../../containers/dropdown_menu_container';\nimport { defineMessages, injectIntl } from 'react-intl';\nimport { isStaff } from 'soapbox/utils/accounts';\nimport EmojiSelector from 'soapbox/components/emoji_selector';\nimport { getReactForStatus } from 'soapbox/utils/emoji_reacts';\n\nconst messages = defineMessages({\n  delete: { id: 'status.delete', defaultMessage: 'Delete' },\n  redraft: { id: 'status.redraft', defaultMessage: 'Delete & re-draft' },\n  direct: { id: 'status.direct', defaultMessage: 'Direct message @{name}' },\n  mention: { id: 'status.mention', defaultMessage: 'Mention @{name}' },\n  reply: { id: 'status.reply', defaultMessage: 'Reply' },\n  reblog: { id: 'status.reblog', defaultMessage: 'Repost' },\n  reblog_private: { id: 'status.reblog_private', defaultMessage: 'Repost to original audience' },\n  cancel_reblog_private: { id: 'status.cancel_reblog_private', defaultMessage: 'Un-repost' },\n  cannot_reblog: { id: 'status.cannot_reblog', defaultMessage: 'This post cannot be reposted' },\n  favourite: { id: 'status.favourite', defaultMessage: 'Like' },\n  mute: { id: 'status.mute', defaultMessage: 'Mute @{name}' },\n  muteConversation: { id: 'status.mute_conversation', defaultMessage: 'Mute conversation' },\n  unmuteConversation: { id: 'status.unmute_conversation', defaultMessage: 'Unmute conversation' },\n  block: { id: 'status.block', defaultMessage: 'Block @{name}' },\n  report: { id: 'status.report', defaultMessage: 'Report @{name}' },\n  share: { id: 'status.share', defaultMessage: 'Share' },\n  pin: { id: 'status.pin', defaultMessage: 'Pin on profile' },\n  unpin: { id: 'status.unpin', defaultMessage: 'Unpin from profile' },\n  embed: { id: 'status.embed', defaultMessage: 'Embed' },\n  admin_account: { id: 'status.admin_account', defaultMessage: 'Open moderation interface for @{name}' },\n  admin_status: { id: 'status.admin_status', defaultMessage: 'Open this post in the moderation interface' },\n  copy: { id: 'status.copy', defaultMessage: 'Copy link to post' },\n  bookmark: { id: 'status.bookmark', defaultMessage: 'Bookmark' },\n  unbookmark: { id: 'status.unbookmark', defaultMessage: 'Remove bookmark' },\n  deactivateUser: { id: 'admin.users.actions.deactivate_user', defaultMessage: 'Deactivate @{name}' },\n  deleteUser: { id: 'admin.users.actions.delete_user', defaultMessage: 'Delete @{name}' },\n  deleteStatus: { id: 'admin.statuses.actions.delete_status', defaultMessage: 'Delete post' },\n  markStatusSensitive: { id: 'admin.statuses.actions.mark_status_sensitive', defaultMessage: 'Mark post sensitive' },\n  markStatusNotSensitive: { id: 'admin.statuses.actions.mark_status_not_sensitive', defaultMessage: 'Mark post not sensitive' },\n});\n\nconst mapStateToProps = state => {\n  const me = state.get('me');\n  return {\n    me,\n    isStaff: isStaff(state.getIn(['accounts', me])),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  onOpenUnauthorizedModal() {\n    dispatch(openModal('UNAUTHORIZED'));\n  },\n});\n\nclass ActionBar extends React.PureComponent {\n\n  static contextTypes = {\n    router: PropTypes.object,\n  };\n\n  static propTypes = {\n    status: ImmutablePropTypes.map.isRequired,\n    onReply: PropTypes.func.isRequired,\n    onReblog: PropTypes.func.isRequired,\n    onFavourite: PropTypes.func.isRequired,\n    onEmojiReact: PropTypes.func.isRequired,\n    onDelete: PropTypes.func.isRequired,\n    onBookmark: PropTypes.func,\n    onDirect: PropTypes.func.isRequired,\n    onMention: PropTypes.func.isRequired,\n    onMute: PropTypes.func,\n    onMuteConversation: PropTypes.func,\n    onBlock: PropTypes.func,\n    onReport: PropTypes.func,\n    onPin: PropTypes.func,\n    onEmbed: PropTypes.func,\n    onDeactivateUser: PropTypes.func,\n    onDeleteUser: PropTypes.func,\n    onDeleteStatus: PropTypes.func,\n    onToggleStatusSensitivity: PropTypes.func,\n    intl: PropTypes.object.isRequired,\n    onOpenUnauthorizedModal: PropTypes.func.isRequired,\n    me: SoapboxPropTypes.me,\n    isStaff: PropTypes.bool.isRequired,\n    allowedEmoji: ImmutablePropTypes.list,\n  };\n\n  static defaultProps = {\n    isStaff: false,\n  }\n\n  state = {\n    emojiSelectorVisible: false,\n  }\n\n  handleReplyClick = () => {\n    const { me } = this.props;\n    if (me) {\n      this.props.onReply(this.props.status);\n    } else {\n      this.props.onOpenUnauthorizedModal();\n    }\n  }\n\n  handleReblogClick = (e) => {\n    const { me } = this.props;\n    if (me) {\n      this.props.onReblog(this.props.status, e);\n    } else {\n      this.props.onOpenUnauthorizedModal();\n    }\n  }\n\n  handleBookmarkClick = () => {\n    this.props.onBookmark(this.props.status);\n  }\n\n  handleFavouriteClick = () => {\n    const { me } = this.props;\n    if (me) {\n      this.props.onFavourite(this.props.status);\n    } else {\n      this.props.onOpenUnauthorizedModal();\n    }\n  }\n\n  isMobile = () => window.matchMedia('only screen and (max-width: 895px)').matches;\n\n  handleLikeButtonHover = e => {\n    if (!this.isMobile()) this.setState({ emojiSelectorVisible: true });\n  }\n\n  handleLikeButtonLeave = e => {\n    if (!this.isMobile()) this.setState({ emojiSelectorVisible: false });\n  }\n\n  handleLikeButtonClick = e => {\n    const meEmojiReact = getReactForStatus(this.props.status, this.props.allowedEmoji) || '👍';\n    if (this.isMobile()) {\n      if (this.state.emojiSelectorVisible) {\n        this.handleReactClick(meEmojiReact)();\n      } else {\n        this.setState({ emojiSelectorVisible: true });\n      }\n    } else {\n      this.handleReactClick(meEmojiReact)();\n    }\n  }\n\n  handleReactClick = emoji => {\n    return e => {\n      const { me } = this.props;\n      if (me) {\n        this.props.onEmojiReact(this.props.status, emoji);\n      } else {\n        this.props.onOpenUnauthorizedModal();\n      }\n      this.setState({ emojiSelectorVisible: false });\n    };\n  }\n\n  handleDeleteClick = () => {\n    this.props.onDelete(this.props.status, this.context.router.history);\n  }\n\n  handleRedraftClick = () => {\n    this.props.onDelete(this.props.status, this.context.router.history, true);\n  }\n\n  handleDirectClick = () => {\n    this.props.onDirect(this.props.status.get('account'), this.context.router.history);\n  }\n\n  handleMentionClick = () => {\n    this.props.onMention(this.props.status.get('account'), this.context.router.history);\n  }\n\n  handleMuteClick = () => {\n    this.props.onMute(this.props.status.get('account'));\n  }\n\n  handleConversationMuteClick = () => {\n    this.props.onMuteConversation(this.props.status);\n  }\n\n  handleBlockClick = () => {\n    this.props.onBlock(this.props.status);\n  }\n\n  handleReport = () => {\n    this.props.onReport(this.props.status);\n  }\n\n  handlePinClick = () => {\n    this.props.onPin(this.props.status);\n  }\n\n  handleShare = () => {\n    navigator.share({\n      text: this.props.status.get('search_index'),\n      url: this.props.status.get('url'),\n    });\n  }\n\n  handleEmbed = () => {\n    this.props.onEmbed(this.props.status);\n  }\n\n  handleCopy = () => {\n    const url      = this.props.status.get('url');\n    const textarea = document.createElement('textarea');\n\n    textarea.textContent    = url;\n    textarea.style.position = 'fixed';\n\n    document.body.appendChild(textarea);\n\n    try {\n      textarea.select();\n      document.execCommand('copy');\n    } catch (e) {\n\n    } finally {\n      document.body.removeChild(textarea);\n    }\n  }\n\n  handleDeactivateUser = () => {\n    this.props.onDeactivateUser(this.props.status);\n  }\n\n  handleDeleteUser = () => {\n    this.props.onDeleteUser(this.props.status);\n  }\n\n  handleToggleStatusSensitivity = () => {\n    this.props.onToggleStatusSensitivity(this.props.status);\n  }\n\n  handleDeleteStatus = () => {\n    this.props.onDeleteStatus(this.props.status);\n  }\n\n  setRef = c => {\n    this.node = c;\n  }\n\n  componentDidMount() {\n    document.addEventListener('click', e => {\n      if (this.node && !this.node.contains(e.target))\n        this.setState({ emojiSelectorVisible: false });\n    });\n  }\n\n  render() {\n    const { status, intl, me, isStaff, allowedEmoji } = this.props;\n    const { emojiSelectorVisible } = this.state;\n\n    const publicStatus = ['public', 'unlisted'].includes(status.get('visibility'));\n    const mutingConversation = status.get('muted');\n    const meEmojiReact = getReactForStatus(status, allowedEmoji);\n\n    let menu = [];\n\n    if (publicStatus) {\n      menu.push({ text: intl.formatMessage(messages.copy), action: this.handleCopy });\n      // menu.push({ text: intl.formatMessage(messages.embed), action: this.handleEmbed });\n    }\n\n    menu.push({ text: intl.formatMessage(status.get('bookmarked') ? messages.unbookmark : messages.bookmark), action: this.handleBookmarkClick });\n\n    menu.push(null);\n\n    if (me === status.getIn(['account', 'id'])) {\n      if (publicStatus) {\n        menu.push({ text: intl.formatMessage(status.get('pinned') ? messages.unpin : messages.pin), action: this.handlePinClick });\n      } else {\n        if (status.get('visibility') === 'private') {\n          menu.push({ text: intl.formatMessage(status.get('reblogged') ? messages.cancel_reblog_private : messages.reblog_private), action: this.handleReblogClick });\n        }\n      }\n\n      menu.push(null);\n      menu.push({ text: intl.formatMessage(mutingConversation ? messages.unmuteConversation : messages.muteConversation), action: this.handleConversationMuteClick });\n      menu.push(null);\n      menu.push({ text: intl.formatMessage(messages.delete), action: this.handleDeleteClick });\n      menu.push({ text: intl.formatMessage(messages.redraft), action: this.handleRedraftClick });\n    } else {\n      menu.push({ text: intl.formatMessage(messages.mention, { name: status.getIn(['account', 'username']) }), action: this.handleMentionClick });\n      //menu.push({ text: intl.formatMessage(messages.direct, { name: status.getIn(['account', 'username']) }), action: this.handleDirectClick });\n      menu.push(null);\n      menu.push({ text: intl.formatMessage(messages.mute, { name: status.getIn(['account', 'username']) }), action: this.handleMuteClick });\n      menu.push({ text: intl.formatMessage(messages.block, { name: status.getIn(['account', 'username']) }), action: this.handleBlockClick });\n      menu.push({ text: intl.formatMessage(messages.report, { name: status.getIn(['account', 'username']) }), action: this.handleReport });\n      if (isStaff) {\n        menu.push(null);\n        menu.push({ text: intl.formatMessage(messages.admin_account, { name: status.getIn(['account', 'username']) }), href: `/pleroma/admin/#/users/${status.getIn(['account', 'id'])}/` });\n        // menu.push({ text: intl.formatMessage(messages.admin_status), href: `/admin/accounts/${status.getIn(['account', 'id'])}/statuses/${status.get('id')}` });\n        menu.push({ text: intl.formatMessage(messages.deactivateUser, { name: status.getIn(['account', 'username']) }), action: this.handleDeactivateUser });\n        menu.push({ text: intl.formatMessage(messages.deleteUser, { name: status.getIn(['account', 'username']) }), action: this.handleDeleteUser });\n        menu.push({ text: intl.formatMessage(status.get('sensitive') === false ? messages.markStatusSensitive : messages.markStatusNotSensitive), action: this.handleToggleStatusSensitivity });\n        menu.push({ text: intl.formatMessage(messages.deleteStatus), action: this.handleDeleteStatus });\n      }\n    }\n\n    const shareButton = ('share' in navigator) && status.get('visibility') === 'public' && (\n      <div className='detailed-status__button'><IconButton title={intl.formatMessage(messages.share)} icon='share-alt' onClick={this.handleShare} /></div>\n    );\n\n    let replyIcon;\n    if (status.get('in_reply_to_id', null) === null) {\n      replyIcon = 'reply';\n    } else {\n      replyIcon = 'reply-all';\n    }\n\n    let reblogIcon = 'retweet';\n    if (status.get('visibility') === 'direct') reblogIcon = 'envelope';\n    else if (status.get('visibility') === 'private') reblogIcon = 'lock';\n\n    let reblog_disabled = (status.get('visibility') === 'direct' || status.get('visibility') === 'private');\n\n    return (\n      <div className='detailed-status__action-bar'>\n        <div className='detailed-status__button'>\n          <IconButton\n            title={intl.formatMessage(messages.reply)}\n            icon={status.get('in_reply_to_account_id') === status.getIn(['account', 'id']) ? 'reply' : replyIcon}\n            onClick={this.handleReplyClick}\n            text={intl.formatMessage(messages.reply)}\n          />\n        </div>\n        <div className='detailed-status__button'>\n          <IconButton\n            disabled={reblog_disabled}\n            active={status.get('reblogged')}\n            title={reblog_disabled ? intl.formatMessage(messages.cannot_reblog) : intl.formatMessage(messages.reblog)}\n            icon={reblogIcon}\n            onClick={this.handleReblogClick}\n            text={intl.formatMessage(messages.reblog)}\n          />\n        </div>\n        <div\n          className='detailed-status__button detailed-status__button--favourite'\n          onMouseEnter={this.handleLikeButtonHover}\n          onMouseLeave={this.handleLikeButtonLeave}\n          ref={this.setRef}\n        >\n          <EmojiSelector onReact={this.handleReactClick} visible={emojiSelectorVisible} />\n          <IconButton\n            className='star-icon'\n            animate\n            active={Boolean(meEmojiReact)}\n            title={intl.formatMessage(messages.favourite)}\n            icon='thumbs-up'\n            emoji={meEmojiReact}\n            text={intl.formatMessage(messages.favourite)}\n            onClick={this.handleLikeButtonClick}\n          />\n        </div>\n        {shareButton}\n\n        <div className='detailed-status__action-bar-dropdown'>\n          <DropdownMenuContainer size={18} icon='ellipsis-h' items={menu} direction='left' title='More' />\n        </div>\n      </div>\n    );\n  }\n\n}\n\nexport default injectIntl(connect(mapStateToProps, mapDispatchToProps)(ActionBar));\n","import Immutable from 'immutable';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport { fetchStatus } from '../../actions/statuses';\nimport MissingIndicator from '../../components/missing_indicator';\nimport DetailedStatus from './components/detailed_status';\nimport ActionBar from './components/action_bar';\nimport Column from '../ui/components/column';\nimport {\n  favourite,\n  unfavourite,\n  reblog,\n  unreblog,\n  bookmark,\n  unbookmark,\n  pin,\n  unpin,\n} from '../../actions/interactions';\nimport { simpleEmojiReact } from '../../actions/emoji_reacts';\nimport {\n  replyCompose,\n  mentionCompose,\n  directCompose,\n} from '../../actions/compose';\nimport { blockAccount } from '../../actions/accounts';\nimport {\n  muteStatus,\n  unmuteStatus,\n  deleteStatus,\n  hideStatus,\n  revealStatus,\n} from '../../actions/statuses';\nimport { initMuteModal } from '../../actions/mutes';\nimport { initReport } from '../../actions/reports';\nimport { makeGetStatus } from '../../selectors';\nimport ColumnHeader from '../../components/column_header';\nimport StatusContainer from '../../containers/status_container';\nimport { openModal } from '../../actions/modal';\nimport { defineMessages, injectIntl, FormattedMessage } from 'react-intl';\nimport ImmutablePureComponent from 'react-immutable-pure-component';\nimport { HotKeys } from 'react-hotkeys';\nimport { attachFullscreenListener, detachFullscreenListener, isFullscreen } from '../ui/util/fullscreen';\nimport { textForScreenReader, defaultMediaVisibility } from '../../components/status';\nimport Icon from 'soapbox/components/icon';\nimport { getSettings } from 'soapbox/actions/settings';\nimport { getSoapboxConfig } from 'soapbox/actions/soapbox';\nimport { deactivateUserModal, deleteUserModal, deleteStatusModal, toggleStatusSensitivityModal } from 'soapbox/actions/moderation';\n\nconst messages = defineMessages({\n  deleteConfirm: { id: 'confirmations.delete.confirm', defaultMessage: 'Delete' },\n  deleteMessage: { id: 'confirmations.delete.message', defaultMessage: 'Are you sure you want to delete this post?' },\n  redraftConfirm: { id: 'confirmations.redraft.confirm', defaultMessage: 'Delete & redraft' },\n  redraftMessage: { id: 'confirmations.redraft.message', defaultMessage: 'Are you sure you want to delete this post and re-draft it? Favorites and reposts will be lost, and replies to the original post will be orphaned.' },\n  blockConfirm: { id: 'confirmations.block.confirm', defaultMessage: 'Block' },\n  revealAll: { id: 'status.show_more_all', defaultMessage: 'Show more for all' },\n  hideAll: { id: 'status.show_less_all', defaultMessage: 'Show less for all' },\n  detailedStatus: { id: 'status.detailed_status', defaultMessage: 'Detailed conversation view' },\n  replyConfirm: { id: 'confirmations.reply.confirm', defaultMessage: 'Reply' },\n  replyMessage: { id: 'confirmations.reply.message', defaultMessage: 'Replying now will overwrite the message you are currently composing. Are you sure you want to proceed?' },\n  blockAndReport: { id: 'confirmations.block.block_and_report', defaultMessage: 'Block & Report' },\n});\n\nconst makeMapStateToProps = () => {\n  const getStatus = makeGetStatus();\n\n  const mapStateToProps = (state, props) => {\n    const status = getStatus(state, {\n      id: props.params.statusId,\n      username: props.params.username,\n    });\n\n    let ancestorsIds = Immutable.List();\n    let descendantsIds = Immutable.List();\n\n    if (status) {\n      ancestorsIds = ancestorsIds.withMutations(mutable => {\n        let id = status.get('in_reply_to_id');\n\n        while (id) {\n          mutable.unshift(id);\n          id = state.getIn(['contexts', 'inReplyTos', id]);\n        }\n      });\n\n      descendantsIds = descendantsIds.withMutations(mutable => {\n        const ids = [status.get('id')];\n\n        while (ids.length > 0) {\n          let id        = ids.shift();\n          const replies = state.getIn(['contexts', 'replies', id]);\n\n          if (status.get('id') !== id) {\n            mutable.push(id);\n          }\n\n          if (replies) {\n            replies.reverse().forEach(reply => {\n              ids.unshift(reply);\n            });\n          }\n        }\n      });\n    }\n\n    return {\n      status,\n      ancestorsIds,\n      descendantsIds,\n      askReplyConfirmation: state.getIn(['compose', 'text']).trim().length !== 0,\n      domain: state.getIn(['meta', 'domain']),\n      me: state.get('me'),\n      displayMedia: getSettings(state).get('displayMedia'),\n      allowedEmoji: getSoapboxConfig(state).get('allowedEmoji'),\n    };\n  };\n\n  return mapStateToProps;\n};\n\nexport default @injectIntl\n@connect(makeMapStateToProps)\nclass Status extends ImmutablePureComponent {\n\n  static contextTypes = {\n    router: PropTypes.object,\n  };\n\n  static propTypes = {\n    params: PropTypes.object.isRequired,\n    dispatch: PropTypes.func.isRequired,\n    status: ImmutablePropTypes.map,\n    ancestorsIds: ImmutablePropTypes.list,\n    descendantsIds: ImmutablePropTypes.list,\n    intl: PropTypes.object.isRequired,\n    askReplyConfirmation: PropTypes.bool,\n    domain: PropTypes.string,\n    displayMedia: PropTypes.string,\n  };\n\n  state = {\n    fullscreen: false,\n    showMedia: defaultMediaVisibility(this.props.status, this.props.displayMedia),\n    loadedStatusId: undefined,\n  };\n\n  componentDidMount() {\n    this.props.dispatch(fetchStatus(this.props.params.statusId));\n    attachFullscreenListener(this.onFullScreenChange);\n  }\n\n  handleToggleMediaVisibility = () => {\n    this.setState({ showMedia: !this.state.showMedia });\n  }\n\n  handleEmojiReactClick = (status, emoji) => {\n    this.props.dispatch(simpleEmojiReact(status, emoji));\n  }\n\n  handleFavouriteClick = (status) => {\n    if (status.get('favourited')) {\n      this.props.dispatch(unfavourite(status));\n    } else {\n      this.props.dispatch(favourite(status));\n    }\n  }\n\n  handlePin = (status) => {\n    if (status.get('pinned')) {\n      this.props.dispatch(unpin(status));\n    } else {\n      this.props.dispatch(pin(status));\n    }\n  }\n\n  handleBookmark = (status) => {\n    if (status.get('bookmarked')) {\n      this.props.dispatch(unbookmark(status));\n    } else {\n      this.props.dispatch(bookmark(status));\n    }\n  }\n\n  handleReplyClick = (status) => {\n    let { askReplyConfirmation, dispatch, intl } = this.props;\n    if (askReplyConfirmation) {\n      dispatch(openModal('CONFIRM', {\n        message: intl.formatMessage(messages.replyMessage),\n        confirm: intl.formatMessage(messages.replyConfirm),\n        onConfirm: () => dispatch(replyCompose(status, this.context.router.history)),\n      }));\n    } else {\n      dispatch(replyCompose(status, this.context.router.history));\n    }\n  }\n\n  handleModalReblog = (status) => {\n    this.props.dispatch(reblog(status));\n  }\n\n  handleReblogClick = (status, e) => {\n    this.props.dispatch((_, getState) => {\n      const boostModal = getSettings(getState()).get('boostModal');\n      if (status.get('reblogged')) {\n        this.props.dispatch(unreblog(status));\n      } else {\n        if ((e && e.shiftKey) || !boostModal) {\n          this.handleModalReblog(status);\n        } else {\n          this.props.dispatch(openModal('BOOST', { status, onReblog: this.handleModalReblog }));\n        }\n      }\n    });\n  }\n\n  handleDeleteClick = (status, history, withRedraft = false) => {\n    const { dispatch, intl } = this.props;\n\n    this.props.dispatch((_, getState) => {\n      const deleteModal = getSettings(getState()).get('deleteModal');\n      if (!deleteModal) {\n        dispatch(deleteStatus(status.get('id'), history, withRedraft));\n      } else {\n        dispatch(openModal('CONFIRM', {\n          message: intl.formatMessage(withRedraft ? messages.redraftMessage : messages.deleteMessage),\n          confirm: intl.formatMessage(withRedraft ? messages.redraftConfirm : messages.deleteConfirm),\n          onConfirm: () => dispatch(deleteStatus(status.get('id'), history, withRedraft)),\n        }));\n      }\n    });\n  }\n\n  handleDirectClick = (account, router) => {\n    this.props.dispatch(directCompose(account, router));\n  }\n\n  handleMentionClick = (account, router) => {\n    this.props.dispatch(mentionCompose(account, router));\n  }\n\n  handleOpenMedia = (media, index) => {\n    this.props.dispatch(openModal('MEDIA', { media, index }));\n  }\n\n  handleOpenVideo = (media, time) => {\n    this.props.dispatch(openModal('VIDEO', { media, time }));\n  }\n\n  handleMuteClick = (account) => {\n    this.props.dispatch(initMuteModal(account));\n  }\n\n  handleConversationMuteClick = (status) => {\n    if (status.get('muted')) {\n      this.props.dispatch(unmuteStatus(status.get('id')));\n    } else {\n      this.props.dispatch(muteStatus(status.get('id')));\n    }\n  }\n\n  handleToggleHidden = (status) => {\n    if (status.get('hidden')) {\n      this.props.dispatch(revealStatus(status.get('id')));\n    } else {\n      this.props.dispatch(hideStatus(status.get('id')));\n    }\n  }\n\n  handleToggleAll = () => {\n    const { status, ancestorsIds, descendantsIds } = this.props;\n    const statusIds = [status.get('id')].concat(ancestorsIds.toJS(), descendantsIds.toJS());\n\n    if (status.get('hidden')) {\n      this.props.dispatch(revealStatus(statusIds));\n    } else {\n      this.props.dispatch(hideStatus(statusIds));\n    }\n  }\n\n  handleBlockClick = (status) => {\n    const { dispatch, intl } = this.props;\n    const account = status.get('account');\n\n    dispatch(openModal('CONFIRM', {\n      message: <FormattedMessage id='confirmations.block.message' defaultMessage='Are you sure you want to block {name}?' values={{ name: <strong>@{account.get('acct')}</strong> }} />,\n      confirm: intl.formatMessage(messages.blockConfirm),\n      onConfirm: () => dispatch(blockAccount(account.get('id'))),\n      secondary: intl.formatMessage(messages.blockAndReport),\n      onSecondary: () => {\n        dispatch(blockAccount(account.get('id')));\n        dispatch(initReport(account, status));\n      },\n    }));\n  }\n\n  handleReport = (status) => {\n    this.props.dispatch(initReport(status.get('account'), status));\n  }\n\n  handleEmbed = (status) => {\n    this.props.dispatch(openModal('EMBED', { url: status.get('url') }));\n  }\n\n  handleDeactivateUser = (status) => {\n    const { dispatch, intl } = this.props;\n    dispatch(deactivateUserModal(intl, status.getIn(['account', 'id'])));\n  }\n\n  handleDeleteUser = (status) => {\n    const { dispatch, intl } = this.props;\n    dispatch(deleteUserModal(intl, status.getIn(['account', 'id'])));\n  }\n\n  handleToggleStatusSensitivity = (status) => {\n    const { dispatch, intl } = this.props;\n    dispatch(toggleStatusSensitivityModal(intl, status.get('id'), status.get('sensitive')));\n  }\n\n  handleDeleteStatus = (status) => {\n    const { dispatch, intl } = this.props;\n    dispatch(deleteStatusModal(intl, status.get('id')));\n  }\n\n  handleHotkeyMoveUp = () => {\n    this.handleMoveUp(this.props.status.get('id'));\n  }\n\n  handleHotkeyMoveDown = () => {\n    this.handleMoveDown(this.props.status.get('id'));\n  }\n\n  handleHotkeyReply = e => {\n    e.preventDefault();\n    this.handleReplyClick(this.props.status);\n  }\n\n  handleHotkeyFavourite = () => {\n    this.handleFavouriteClick(this.props.status);\n  }\n\n  handleHotkeyBoost = () => {\n    this.handleReblogClick(this.props.status);\n  }\n\n  handleHotkeyMention = e => {\n    e.preventDefault();\n    this.handleMentionClick(this.props.status.get('account'));\n  }\n\n  handleHotkeyOpenProfile = () => {\n    this.context.router.history.push(`/@${this.props.status.getIn(['account', 'acct'])}`);\n  }\n\n  handleHotkeyToggleHidden = () => {\n    this.handleToggleHidden(this.props.status);\n  }\n\n  handleHotkeyToggleSensitive = () => {\n    this.handleToggleMediaVisibility();\n  }\n\n  handleMoveUp = id => {\n    const { status, ancestorsIds, descendantsIds } = this.props;\n\n    if (id === status.get('id')) {\n      this._selectChild(ancestorsIds.size - 1, true);\n    } else {\n      let index = ancestorsIds.indexOf(id);\n\n      if (index === -1) {\n        index = descendantsIds.indexOf(id);\n        this._selectChild(ancestorsIds.size + index, true);\n      } else {\n        this._selectChild(index - 1, true);\n      }\n    }\n  }\n\n  handleMoveDown = id => {\n    const { status, ancestorsIds, descendantsIds } = this.props;\n\n    if (id === status.get('id')) {\n      this._selectChild(ancestorsIds.size + 1, false);\n    } else {\n      let index = ancestorsIds.indexOf(id);\n\n      if (index === -1) {\n        index = descendantsIds.indexOf(id);\n        this._selectChild(ancestorsIds.size + index + 2, false);\n      } else {\n        this._selectChild(index + 1, false);\n      }\n    }\n  }\n\n  _selectChild(index, align_top) {\n    const container = this.node;\n    const element = container.querySelectorAll('.focusable')[index];\n\n    if (element) {\n      if (align_top && container.scrollTop > element.offsetTop) {\n        element.scrollIntoView(true);\n      } else if (!align_top && container.scrollTop + container.clientHeight < element.offsetTop + element.offsetHeight) {\n        element.scrollIntoView(false);\n      }\n      element.focus();\n    }\n  }\n\n  renderChildren(list) {\n    return list.map(id => (\n      <StatusContainer\n        key={id}\n        id={id}\n        onMoveUp={this.handleMoveUp}\n        onMoveDown={this.handleMoveDown}\n        contextType='thread'\n      />\n    ));\n  }\n\n  setRef = c => {\n    this.node = c;\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { params, status } = this.props;\n    const { ancestorsIds } = prevProps;\n\n    if (params.statusId !== prevProps.params.statusId && params.statusId) {\n      this._scrolledIntoView = false;\n      this.props.dispatch(fetchStatus(params.statusId));\n    }\n\n    if (status && status.get('id') !== prevState.loadedStatusId) {\n      this.setState({ showMedia: defaultMediaVisibility(status), loadedStatusId: status.get('id') });\n    }\n\n    if (this._scrolledIntoView) {\n      return;\n    }\n\n    if (prevProps.status && ancestorsIds && ancestorsIds.size > 0) {\n      const element = this.node.querySelector('.detailed-status');\n\n      window.requestAnimationFrame(() => {\n        element.scrollIntoView(true);\n      });\n      this._scrolledIntoView = true;\n    }\n  }\n\n  componentWillUnmount() {\n    detachFullscreenListener(this.onFullScreenChange);\n  }\n\n  onFullScreenChange = () => {\n    this.setState({ fullscreen: isFullscreen() });\n  }\n\n  render() {\n    let ancestors, descendants;\n    const { status, ancestorsIds, descendantsIds, intl, domain, me } = this.props;\n\n    if (status === null) {\n      return (\n        <Column>\n          <MissingIndicator />\n        </Column>\n      );\n    }\n\n    if (ancestorsIds && ancestorsIds.size > 0) {\n      ancestors = <div>{this.renderChildren(ancestorsIds)}</div>;\n    }\n\n    if (descendantsIds && descendantsIds.size > 0) {\n      descendants = <div>{this.renderChildren(descendantsIds)}</div>;\n    }\n\n    const handlers = {\n      moveUp: this.handleHotkeyMoveUp,\n      moveDown: this.handleHotkeyMoveDown,\n      reply: this.handleHotkeyReply,\n      favourite: this.handleHotkeyFavourite,\n      boost: this.handleHotkeyBoost,\n      mention: this.handleHotkeyMention,\n      openProfile: this.handleHotkeyOpenProfile,\n      toggleHidden: this.handleHotkeyToggleHidden,\n      toggleSensitive: this.handleHotkeyToggleSensitive,\n    };\n\n    return (\n      <Column label={intl.formatMessage(messages.detailedStatus)}>\n        { me &&\n          <ColumnHeader\n            extraButton={(\n              <button\n                className='column-header__button'\n                title={intl.formatMessage(status.get('hidden') ? messages.revealAll : messages.hideAll)}\n                aria-label={intl.formatMessage(status.get('hidden') ? messages.revealAll : messages.hideAll)}\n                onClick={this.handleToggleAll}\n                aria-pressed={\n                  status.get('hidden') ? 'false' : 'true'}\n              >\n                <Icon id={status.get('hidden') ? 'eye-slash' : 'eye'\n                }\n                />\n              </button>\n            )}\n          />\n        }\n\n        <div ref={this.setRef}>\n          {ancestors}\n\n          <HotKeys handlers={handlers}>\n            <div className={classNames('focusable', 'detailed-status__wrapper')} tabIndex='0' aria-label={textForScreenReader(intl, status, false)}>\n              <DetailedStatus\n                status={status}\n                onOpenVideo={this.handleOpenVideo}\n                onOpenMedia={this.handleOpenMedia}\n                onToggleHidden={this.handleToggleHidden}\n                domain={domain}\n                showMedia={this.state.showMedia}\n                onToggleMediaVisibility={this.handleToggleMediaVisibility}\n              />\n\n              <ActionBar\n                status={status}\n                onReply={this.handleReplyClick}\n                onFavourite={this.handleFavouriteClick}\n                onEmojiReact={this.handleEmojiReactClick}\n                onReblog={this.handleReblogClick}\n                onDelete={this.handleDeleteClick}\n                onDirect={this.handleDirectClick}\n                onMention={this.handleMentionClick}\n                onMute={this.handleMuteClick}\n                onMuteConversation={this.handleConversationMuteClick}\n                onBlock={this.handleBlockClick}\n                onReport={this.handleReport}\n                onPin={this.handlePin}\n                onBookmark={this.handleBookmark}\n                onEmbed={this.handleEmbed}\n                onDeactivateUser={this.handleDeactivateUser}\n                onDeleteUser={this.handleDeleteUser}\n                onToggleStatusSensitivity={this.handleToggleStatusSensitivity}\n                onDeleteStatus={this.handleDeleteStatus}\n                allowedEmoji={this.props.allowedEmoji}\n              />\n            </div>\n          </HotKeys>\n\n          {descendants}\n        </div>\n      </Column>\n    );\n  }\n\n}\n"],"sourceRoot":""}