(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{742:function(e,t,n){"use strict";n.r(t);var a,o,s,c=n(0),i=n(2),r=n(7),l=n(1),d=n(3),u=n.n(d),p=n(12),h=n(669),b=n(665),f=n(111),v=n(245),m=n(6),j=n(672),O=n(22),g=n(31),M=n(63),y=n.n(M),_=n(5),w=n.n(_),C=n(18),k=n.n(C),I=n(19),R=n(223),x=n(276),S=n(637),D=n(685),L=n(286),T=n(51),U=n(100),H=n(287),N=Object(m.f)({more:{id:"status.more",defaultMessage:"More"},open:{id:"conversation.open",defaultMessage:"View conversation"},reply:{id:"status.reply",defaultMessage:"Reply"},markAsRead:{id:"conversation.mark_as_read",defaultMessage:"Mark as read"},delete:{id:"conversation.delete",defaultMessage:"Delete conversation"},muteConversation:{id:"status.mute_conversation",defaultMessage:"Mute conversation"},unmuteConversation:{id:"status.unmute_conversation",defaultMessage:"Unmute conversation"}}),A=Object(m.g)((s=o=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,Object(l.a)(Object(i.a)(t),"handleClick",function(){if(t.context.router){var e=t.props,n=e.lastStatus,a=e.unread,o=e.markRead;a&&o(),t.context.router.history.push("/statuses/"+n.get("id"))}}),Object(l.a)(Object(i.a)(t),"handleMarkAsRead",function(){t.props.markRead()}),Object(l.a)(Object(i.a)(t),"handleReply",function(){t.props.reply(t.props.lastStatus,t.context.router.history)}),Object(l.a)(Object(i.a)(t),"handleDelete",function(){t.props.delete()}),Object(l.a)(Object(i.a)(t),"handleHotkeyMoveUp",function(){t.props.onMoveUp(t.props.conversationId)}),Object(l.a)(Object(i.a)(t),"handleHotkeyMoveDown",function(){t.props.onMoveDown(t.props.conversationId)}),Object(l.a)(Object(i.a)(t),"handleConversationMute",function(){t.props.onMute(t.props.lastStatus)}),Object(l.a)(Object(i.a)(t),"handleShowMore",function(){t.props.onToggleHidden(t.props.lastStatus)}),t}return Object(r.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.accounts,n=e.lastStatus,a=e.unread,o=e.intl;if(null===n)return null;var s=[{text:o.formatMessage(N.open),action:this.handleClick},null];s.push({text:o.formatMessage(n.get("muted")?N.unmuteConversation:N.muteConversation),action:this.handleConversationMute}),a&&(s.push({text:o.formatMessage(N.markAsRead),action:this.handleMarkAsRead}),s.push(null)),s.push({text:o.formatMessage(N.delete),action:this.handleDelete});var i=t.map(function(e){return Object(c.a)(L.a,{to:"/accounts/"+e.get("id"),href:e.get("url"),title:e.get("acct")},e.get("id"),Object(c.a)("bdi",{},void 0,Object(c.a)("strong",{className:"display-name__html",dangerouslySetInnerHTML:{__html:e.get("display_name_html")}})))}).reduce(function(e,t){return[e,", ",t]}),r={reply:this.handleReply,open:this.handleClick,moveUp:this.handleHotkeyMoveUp,moveDown:this.handleHotkeyMoveDown,toggleHidden:this.handleShowMore};return Object(c.a)(H.HotKeys,{handlers:r},void 0,Object(c.a)("div",{className:"conversation focusable muted",tabIndex:"0"},void 0,Object(c.a)("div",{className:"conversation__avatar"},void 0,Object(c.a)(D.a,{accounts:t,size:48})),Object(c.a)("div",{className:"conversation__content"},void 0,Object(c.a)("div",{className:"conversation__content__info"},void 0,Object(c.a)("div",{className:"conversation__content__relative-time"},void 0,Object(c.a)(U.default,{timestamp:n.get("created_at")})),Object(c.a)("div",{className:"conversation__content__names"},void 0,Object(c.a)(m.b,{id:"conversation.with",defaultMessage:"With {names}",values:{names:Object(c.a)("span",{},void 0,i)}}))),Object(c.a)(R.a,{status:n,onClick:this.handleClick,expanded:!n.get("hidden"),onExpandedToggle:this.handleShowMore,collapsable:!0}),n.get("media_attachments").size>0&&Object(c.a)(x.a,{compact:!0,media:n.get("media_attachments")}),Object(c.a)("div",{className:"status__action-bar"},void 0,Object(c.a)(T.a,{className:"status__action-bar-button",title:o.formatMessage(N.reply),icon:"reply",onClick:this.handleReply}),Object(c.a)("div",{className:"status__action-bar-dropdown"},void 0,Object(c.a)(S.a,{status:n,items:s,icon:"ellipsis-h",size:18,direction:"right",title:o.formatMessage(N.more)}))))))},t}(I.a),Object(l.a)(o,"contextTypes",{router:w.a.object}),Object(l.a)(o,"propTypes",{conversationId:w.a.string.isRequired,accounts:k.a.list.isRequired,lastStatus:k.a.map,unread:w.a.bool.isRequired,onMoveUp:w.a.func,onMoveDown:w.a.func,markRead:w.a.func.isRequired,intl:w.a.object.isRequired}),a=s))||a,q=n(204),E=n(21),P=n(47),z=n(93),K=Object(m.f)({replyConfirm:{id:"confirmations.reply.confirm",defaultMessage:"Reply"},replyMessage:{id:"confirmations.reply.message",defaultMessage:"Replying now will overwrite the message you are currently composing. Are you sure you want to proceed?"}}),V=Object(m.g)(Object(p.connect)(function(){var e=Object(q.f)();return function(t,n){var a=n.conversationId,o=t.getIn(["conversations","items"]).find(function(e){return e.get("id")===a}),s=o.get("last_status",null);return{accounts:o.get("accounts").map(function(e){return t.getIn(["accounts",e],null)}),unread:o.get("unread"),lastStatus:s&&e(t,{id:s})}}},function(e,t){var n=t.intl,a=t.conversationId;return{markRead:function(){e(Object(f.j)(a))},reply:function(t,a){e(function(o,s){0!==s().getIn(["compose","text"]).trim().length?e(Object(P.d)("CONFIRM",{message:n.formatMessage(K.replyMessage),confirm:n.formatMessage(K.replyConfirm),onConfirm:function(){return e(Object(E.gb)(t,a))}})):e(Object(E.gb)(t,a))})},delete:function(){e(Object(f.h)(a))},onMute:function(t){t.get("muted")?e(Object(z.l)(t.get("id"))):e(Object(z.j)(t.get("id")))},onToggleHidden:function(t){t.get("hidden")?e(Object(z.k)(t.get("id"))):e(Object(z.i)(t.get("id")))}}})(A)),W=n(964),J=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,Object(l.a)(Object(i.a)(t),"getCurrentIndex",function(e){return t.props.conversations.findIndex(function(t){return t.get("id")===e})}),Object(l.a)(Object(i.a)(t),"handleMoveUp",function(e){var n=t.getCurrentIndex(e)-1;t._selectChild(n,!0)}),Object(l.a)(Object(i.a)(t),"handleMoveDown",function(e){var n=t.getCurrentIndex(e)+1;t._selectChild(n,!1)}),Object(l.a)(Object(i.a)(t),"setRef",function(e){t.node=e}),Object(l.a)(Object(i.a)(t),"handleLoadOlder",y()(function(){var e=t.props.conversations.last();e&&e.get("last_status")&&t.props.onLoadMore(e.get("last_status"))},300,{leading:!0})),t}Object(r.a)(t,e);var n=t.prototype;return n._selectChild=function(e,t){var n=this.node.node,a=n.querySelector("article:nth-of-type("+(e+1)+") .focusable");a&&(t&&n.scrollTop>a.offsetTop?a.scrollIntoView(!0):!t&&n.scrollTop+n.clientHeight<a.offsetTop+a.offsetHeight&&a.scrollIntoView(!1),a.focus())},n.render=function(){var e=this,t=this.props,n=t.conversations,a=t.onLoadMore,o=Object(g.default)(t,["conversations","onLoadMore"]);return u.a.createElement(W.a,Object(O.a)({},o,{onLoadMore:a&&this.handleLoadOlder,scrollKey:"direct",ref:this.setRef}),n.map(function(t){return Object(c.a)(V,{conversationId:t.get("id"),onMoveUp:e.handleMoveUp,onMoveDown:e.handleMoveDown},t.get("id"))}))},t}(I.a);Object(l.a)(J,"propTypes",{conversations:k.a.list.isRequired,hasMore:w.a.bool,isLoading:w.a.bool,onLoadMore:w.a.func,shouldUpdateScroll:w.a.func});var F,Y=Object(p.connect)(function(e){return{conversations:e.getIn(["conversations","items"]),isLoading:e.getIn(["conversations","isLoading"],!0),hasMore:e.getIn(["conversations","hasMore"],!1)}},function(e){return{onLoadMore:function(t){return e(Object(f.i)({maxId:t}))}}})(J);n.d(t,"default",function(){return G});var B=Object(m.f)({title:{id:"column.direct",defaultMessage:"Direct messages"}}),G=Object(p.connect)()(F=Object(m.g)(F=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,Object(l.a)(Object(i.a)(t),"handlePin",function(){var e=t.props,n=e.columnId,a=e.dispatch;a(n?Object(v.h)(n):Object(v.e)("DIRECT",{}))}),Object(l.a)(Object(i.a)(t),"handleMove",function(e){var n=t.props,a=n.columnId;(0,n.dispatch)(Object(v.g)(a,e))}),Object(l.a)(Object(i.a)(t),"handleHeaderClick",function(){t.column.scrollTop()}),Object(l.a)(Object(i.a)(t),"setRef",function(e){t.column=e}),Object(l.a)(Object(i.a)(t),"handleLoadMore",function(e){t.props.dispatch(Object(f.i)({maxId:e}))}),t}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props.dispatch;e(Object(f.k)()),e(Object(f.i)()),this.disconnect=e(Object(j.b)())},n.componentWillUnmount=function(){this.props.dispatch(Object(f.l)()),this.disconnect&&(this.disconnect(),this.disconnect=null)},n.render=function(){var e=this.props,t=e.intl,n=e.hasUnread,a=e.columnId,o=e.multiColumn,s=e.shouldUpdateScroll,i=!!a;return u.a.createElement(h.a,{bindToDocument:!o,ref:this.setRef,label:t.formatMessage(B.title)},Object(c.a)(b.a,{icon:"envelope",active:n,title:t.formatMessage(B.title),onPin:this.handlePin,onMove:this.handleMove,onClick:this.handleHeaderClick,pinned:i,multiColumn:o}),Object(c.a)(Y,{trackScroll:!i,scrollKey:"direct_timeline-"+a,timelineId:"direct",onLoadMore:this.handleLoadMore,emptyMessage:Object(c.a)(m.b,{id:"empty_column.direct",defaultMessage:"You don't have any direct messages yet. When you send or receive one, it will show up here."}),shouldUpdateScroll:s}))},t}(u.a.PureComponent))||F)||F}}]);
//# sourceMappingURL=direct_timeline.js.map